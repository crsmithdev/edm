# Design: Fix XXE Vulnerability

## Approach

Replace stdlib `xml.etree.ElementTree` with `defusedxml.ElementTree` which disables dangerous XML features by default.

## Implementation

### File: `src/edm/data/rekordbox.py`

**Before:**
```python
import xml.etree.ElementTree as ET

def parse_rekordbox_xml(xml_path: Path) -> list[RekordboxTrack]:
    tree = ET.parse(xml_path)  # VULNERABLE
```

**After:**
```python
import defusedxml.ElementTree as ET

def parse_rekordbox_xml(xml_path: Path) -> list[RekordboxTrack]:
    tree = ET.parse(xml_path)  # SAFE - defusedxml disables XXE by default
```

### File: `pyproject.toml`

Add dependency:
```toml
dependencies = [
    ...
    "defusedxml>=0.7.1",
]
```

## Testing

### Security Test Cases

Create `tests/security/test_xxe.py`:

```python
def test_xxe_attack_prevented():
    """Test that XXE attacks are prevented."""
    malicious_xml = """<?xml version="1.0"?>
    <!DOCTYPE foo [
      <!ENTITY xxe SYSTEM "file:///etc/passwd">
    ]>
    <DJ_PLAYLISTS>
      <TRACK Name="&xxe;"/>
    </DJ_PLAYLISTS>
    """

    with pytest.raises(Exception):  # Should reject malicious XML
        parse_rekordbox_xml_from_string(malicious_xml)
```

## Risks

- **Minimal**: defusedxml is a drop-in replacement
- **Existing tests**: Should all pass unchanged
- **Performance**: Negligible overhead
