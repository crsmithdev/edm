---
status: ready
created: 2025-12-05
updated: 2025-12-05
---

# [SECXXE] Fix XML External Entity (XXE) Injection Vulnerability

## Why

**Security Vulnerability**: `src/edm/data/rekordbox.py:69` uses `ET.parse()` without disabling external entity processing, creating an XXE injection vulnerability.

**Risk**: Malicious Rekordbox XML files could:
- Read arbitrary files from the system
- Cause Denial of Service attacks
- Potentially execute remote code

**Severity**: CRITICAL - This is an OWASP Top 10 vulnerability that could compromise user systems.

## What

### Files Affected
- `src/edm/data/rekordbox.py` (line 69) - XML parsing logic

### Specs Affected
- Security requirements (needs to be added to project specs)

## Impact

### Breaking Changes
None - this is a transparent security fix.

### Migration Required
None - users don't need to change anything.

### Risks
- **Low risk**: defusedxml is a well-maintained drop-in replacement
- **Benefit**: Eliminates critical security vulnerability
- **Testing**: Existing tests should pass; add malicious XML test cases

### Dependencies
- Add `defusedxml>=0.7.1` to `pyproject.toml`
